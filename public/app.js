var app=angular.module("main",["firebase","ui.router","ngAnimate"]).config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/home"),$stateProvider.state("home",{url:"/",templateUrl:"./app/home/home.html",controller:function(appFactory){appFactory.resetGenres()}}).state("about",{url:"/about",templateUrl:"./app/about/about.html"}).state("signup",{url:"/signup",templateUrl:"./app/authentication/signup.html"}).state("signin",{url:"/signin",templateUrl:"./app/authentication/signin.html"}).state("userProfile",{url:"/userProfile?userName",templateUrl:"./app/userProfile/userProfile.html",controller:function($scope,$stateParams){$scope.userName=$stateParams.userName}}).state("oauth2callback",{url:"/oauth2callback/:accessToken",templateUrl:"./app/event/event.html",controller:function($scope,$stateParams){alert("is this working!??!"),$scope.accessToken=$stateParams.accessToken,console.log("params access token"+$stateParams.accessToken),console.log("Scope access token"+$scope.accessToken)}}).state("createEvent",{url:"/createEvent",templateUrl:"./app/createEvent/createEvent.html"}).state("event",{url:"/event?eventId",templateUrl:"./app/event/event.html",controller:function($scope,$stateParams){$scope.eventId=$stateParams.eventId}}).state("editevent",{url:"/editevent/:eventId",templateUrl:"./app/event/editevent.html",controller:function($scope,$stateParams){$scope.eventId=$stateParams.eventId}})}]).run(["$state",function($state){$state.transitionTo("home")}]).controller("mainCtrl",["$scope","$firebaseObject","$state","$location","$timeout","appFactory",function($scope,$firebaseObject,$state,$location,$timeout,appFactory){var ref=appFactory.firebase,userAuth=ref.getAuth();$scope.auth=function(){return null!==ref.getAuth()},appFactory.userInit(),$scope.goProfile=function(){$scope.userName="",$scope.userAuth=ref.getAuth(),$scope.userAuth&&appFactory.accessUserByUid($scope.userAuth.uid,function(userData){appFactory.update($scope,function(scope){$scope.userName=userData.val().username,appFactory.user=userData.val().username,console.log("app user assignment"+appFactory.user),$state.go("userProfile",{userName:$scope.userName})})})},$scope.signIn=function(){$scope.showHamburgerMenu=!1,appFactory.prevRoute={state:$location.path().slice(1)||"home",params:$location.search()},$state.go("signin")},$scope.signOut=function(){$scope.showHamburgerMenu=!1,ref.unauth(),$scope.userAuth=null,appFactory.user=null},$scope.newNotifications=!1,$scope.notifications=appFactory.notifications,$scope.getTimeStamp=appFactory.getTimeStamp,$scope.noNotificationsLeft=appFactory.noNotificationsLeft,console.log("scope new notifs",$scope.newNotifications),null!==userAuth&&appFactory.getNotifications(ref.getAuth().uid,$scope),window.data=function(){console.log("scope new notifs",$scope.newNotifications)},$scope.$watch(function(scope){return appFactory.newNotifications},function(nv,ov){appFactory.update($scope,function(scope){scope.newNotifications=nv})}),$scope.showNotificationsList=!1,$scope.showNotificationsListNow=function(){$scope.showNotificationsList=!$scope.showNotificationsList},$scope.goNotificationLink=function(url){"userProfile"===url[0]?$state.go(url[0],{userName:url[1]}):"event"===url[0]?$state.go(url[0],{eventId:url[1]}):$scope.goProfile()},$scope.deleteNotification=function(notificationId){appFactory.deleteNotification(notificationId),appFactory.noNotificationsLeft()&&$timeout(function(){$scope.showNotificationsList=!1,appFactory.update($scope,function(scope){scope.newNotifications=!1})},1e3)},$scope.deleteAllNotifications=function(){appFactory.accessUserByUid(ref.getAuth().uid,function(userData){var userName=userData.val().username;appFactory.deleteAllNotifications(userName),$timeout(function(){$scope.showNotificationsList=!1,appFactory.update($scope,function(scope){scope.newNotifications=!1})},1e3)})},$scope.showHamburgerMenu=!1,$scope.showHamburgerMenuNow=function(){$scope.showHamburgerMenu=!$scope.showHamburgerMenu},$scope.hideHamburgerMenu=function(){$scope.showHamburgerMenu=!1};var syncObject=$firebaseObject(ref);syncObject.$bindTo($scope,"data"),$state.go("home")}]);